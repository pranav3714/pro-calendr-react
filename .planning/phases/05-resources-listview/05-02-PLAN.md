---
phase: 05-resources-listview
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - packages/core/src/views/list/ListView.tsx
  - packages/core/src/views/list/ListDateGroup.tsx
  - packages/core/src/views/list/ListEventRow.tsx
  - packages/core/src/views/list/index.ts
  - packages/core/src/components/CalendarBody.tsx
  - packages/core/src/styles/calendar.css
autonomous: true

must_haves:
  truths:
    - "User can switch to list view and see events sorted chronologically and grouped by date"
    - "Each date group has a sticky header showing the formatted date"
    - "Each event row shows a color dot, time range, and title"
    - "Clicking an event row triggers onEventClick callback"
    - "Empty state displays a message when no events exist in the date range"
    - "Custom eventContent render slot works in list view event rows"
  artifacts:
    - path: "packages/core/src/views/list/ListView.tsx"
      provides: "Root list view component with date grouping and empty state"
      exports: ["ListView"]
      min_lines: 30
    - path: "packages/core/src/views/list/ListDateGroup.tsx"
      provides: "Date group section with sticky header and event rows"
      exports: ["ListDateGroup"]
    - path: "packages/core/src/views/list/ListEventRow.tsx"
      provides: "Individual event row with dot, time, title, and click handler"
      exports: ["ListEventRow"]
    - path: "packages/core/src/components/CalendarBody.tsx"
      provides: "ListView routing in renderView switch"
      contains: "case \"list\""
    - path: "packages/core/src/styles/calendar.css"
      provides: "List view CSS structural styles using --cal-* variables"
      contains: "pro-calendr-react-list"
  key_links:
    - from: "packages/core/src/views/list/ListView.tsx"
      to: "packages/core/src/utils/event-filter.ts"
      via: "filterEventsInRange, sortEventsByStart, groupEventsByDate"
      pattern: "filterEventsInRange|sortEventsByStart|groupEventsByDate"
    - from: "packages/core/src/components/CalendarBody.tsx"
      to: "packages/core/src/views/list/ListView.tsx"
      via: "import and render in switch case"
      pattern: "import.*ListView|case.*list"
    - from: "packages/core/src/views/list/ListEventRow.tsx"
      to: "onEventClick callback"
      via: "onClick handler on row element"
      pattern: "onEventClick|onClick"
---

<objective>
Build the ListView component as a chronological event list grouped by date, with sub-components for date groups and event rows, wire it into CalendarBody view routing, and add structural CSS.

Purpose: Delivers VIEW-07 -- users can switch to "list" view and see their events in a scannable vertical list organized by date, with clickable rows and customizable event content.
Output: Working ListView with ListDateGroup, ListEventRow, CalendarBody routing, and complete CSS styles.
</objective>

<execution_context>
@/home/blacksilver/.claude-personal/get-shit-done/workflows/execute-plan.md
@/home/blacksilver/.claude-personal/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-resources-listview/05-RESEARCH.md
@.planning/phases/05-resources-listview/05-01-SUMMARY.md
@packages/core/src/views/list/ListView.tsx
@packages/core/src/views/list/index.ts
@packages/core/src/components/CalendarBody.tsx
@packages/core/src/components/CalendarContext.tsx
@packages/core/src/components/CalendarProvider.tsx
@packages/core/src/utils/event-filter.ts
@packages/core/src/utils/date-utils.ts
@packages/core/src/utils/cn.ts
@packages/core/src/types/event.ts
@packages/core/src/types/theme.ts
@packages/core/src/styles/calendar.css
@packages/core/src/views/month/MonthView.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement ListView, ListDateGroup, and ListEventRow components</name>
  <files>
    packages/core/src/views/list/ListView.tsx
    packages/core/src/views/list/ListDateGroup.tsx
    packages/core/src/views/list/ListEventRow.tsx
    packages/core/src/views/list/index.ts
  </files>
  <action>
**ListView.tsx:** Replace the stub with a full implementation:
- Props interface `ListViewProps`: `events: CalendarEvent[]`, `dateRange: { start: Date; end: Date }`, `eventContent?: (props: EventContentProps) => ReactNode`, `onEventClick?: (event: CalendarEvent, nativeEvent: React.MouseEvent) => void`
- Read `classNames` and `hour12` from `useCalendarConfig()`
- In useMemo:
  1. Call `filterEventsInRange(events, dateRange)` to get visible events
  2. Call `sortEventsByStart(filtered)` to order chronologically
  3. Call `groupEventsByDate(sorted)` to group by date key (YYYY-MM-DD)
- If no events (map size === 0), render empty state: `<div className={cn("pro-calendr-react-list", classNames?.listView)}><div className={cn("pro-calendr-react-list-empty", classNames?.listEmptyMessage)}>No events to display</div></div>`
- Sort date keys chronologically: `[...groupedEvents.keys()].sort()`
- Render root `<div>` with:
  - `data-testid="pro-calendr-react-list"`
  - `className={cn("pro-calendr-react-list", classNames?.listView)}`
  - `role="list"` and `aria-label="Event list"`
- Map sorted date keys to `<ListDateGroup>` components passing: `dateKey`, `events`, `eventContent`, `onEventClick`, `hour12`

**ListDateGroup.tsx:** Create a new component for date-grouped sections:
- Props: `dateKey: string` (YYYY-MM-DD), `events: CalendarEvent[]`, `eventContent?`, `onEventClick?`, `hour12: boolean`
- Read `classNames` from `useCalendarConfig()`
- Parse dateKey into a Date object, format as readable string using `formatDate(date, "EEEE, MMMM d, yyyy")` from date-utils (e.g., "Monday, February 9, 2026")
- Render container `<div role="listitem">` with:
  - Sticky date header: `<div className={cn("pro-calendr-react-list-date-header", classNames?.listDateHeader)}>{formattedDate}</div>`
  - Event rows: map events to `<ListEventRow>` passing: `event`, `eventContent`, `onEventClick`, `hour12`

**ListEventRow.tsx:** Create a new component for individual event rows:
- Props: `event: CalendarEvent`, `eventContent?`, `onEventClick?`, `hour12: boolean`
- Read `classNames` from `useCalendarConfig()`
- Compute time display string:
  - If `event.allDay` is true, show "All day"
  - Otherwise, format start and end times using `formatDate(parseDate(event.start), hour12 ? "h:mm a" : "HH:mm")` with an en-dash separator
- Compute event color: use `event.color ?? event.extendedProps?.color` (fallback to CSS variable via class)
- Render `<div>` with:
  - `className={cn("pro-calendr-react-list-event-row", classNames?.listEventRow)}`
  - `role="listitem"`
  - `tabIndex={0}` for keyboard accessibility
  - `onClick` handler: if `onEventClick`, call `onEventClick(event, nativeEvent)`
  - `onKeyDown` handler: if Enter or Space, prevent default and call `onEventClick` with a synthetic mouse event (or just call the callback with the event and a minimal event object)
- Inside the row:
  - Color dot: `<span className="pro-calendr-react-list-event-dot" style={eventColor ? { backgroundColor: eventColor } : undefined} />`
  - Time: `<span className="pro-calendr-react-list-event-time">{timeDisplay}</span>`
  - Title area: if `eventContent` render slot is provided, call `eventContent({ event })`. Otherwise render `<span className="pro-calendr-react-list-event-title">{event.title}</span>`

**views/list/index.ts:** Update to also export ListDateGroup and ListEventRow:
- `export { ListView } from "./ListView";`
- `export { ListDateGroup } from "./ListDateGroup";`
- `export { ListEventRow } from "./ListEventRow";`
  </action>
  <verify>
Run `pnpm typecheck` -- no type errors.
Run `pnpm lint` -- no lint errors.
  </verify>
  <done>ListView renders events grouped by date with sticky headers, color dots, formatted times, click handlers, and empty state. eventContent render slot is supported. ListDateGroup and ListEventRow are separate, focused components.</done>
</task>

<task type="auto">
  <name>Task 2: Wire ListView into CalendarBody and add list view CSS</name>
  <files>
    packages/core/src/components/CalendarBody.tsx
    packages/core/src/styles/calendar.css
  </files>
  <action>
**CalendarBody.tsx:**
- Add import: `import { ListView } from "../views/list/ListView";`
- Create `listViewProps` object alongside existing viewProps and monthViewProps:
  ```
  const listViewProps = {
    events: config.events,
    dateRange,
    eventContent: config.eventContent,
    onEventClick: handleEventClick,
  };
  ```
- Add `case "list":` to the `renderView()` switch statement: `return <ListView {...listViewProps} />;`
- The existing `default: return null` handles unknown views

**calendar.css:** Add list view structural styles at the end of the file (before any closing comments), following the existing CSS variable pattern:
```css
/* ---- List View ---- */
.pro-calendr-react-list {
  display: flex;
  flex-direction: column;
  width: 100%;
  overflow-y: auto;
}

.pro-calendr-react-list-date-header {
  padding: var(--cal-slot-padding, 8px 16px);
  font-size: var(--cal-font-size);
  font-weight: var(--cal-font-weight-bold, 600);
  color: var(--cal-text);
  background-color: var(--cal-bg-muted);
  border-bottom: var(--cal-border-width, 1px) solid var(--cal-border);
  position: sticky;
  top: 0;
  z-index: 2;
}

.pro-calendr-react-list-event-row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 8px 16px;
  border-bottom: var(--cal-border-width, 1px) solid var(--cal-border);
  cursor: pointer;
  outline: none;
}

.pro-calendr-react-list-event-row:hover {
  background-color: var(--cal-bg-hover);
}

.pro-calendr-react-list-event-row:focus-visible {
  box-shadow: inset 0 0 0 2px var(--cal-focus-ring, #3b82f6);
}

.pro-calendr-react-list-event-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  flex-shrink: 0;
  background-color: var(--cal-event-default-bg);
}

.pro-calendr-react-list-event-time {
  font-size: var(--cal-font-size-sm);
  color: var(--cal-text-muted);
  min-width: 120px;
  flex-shrink: 0;
}

.pro-calendr-react-list-event-title {
  font-size: var(--cal-font-size);
  color: var(--cal-text);
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.pro-calendr-react-list-empty {
  padding: 48px 16px;
  text-align: center;
  color: var(--cal-text-muted);
  font-size: var(--cal-font-size);
}
```

Use `var(--cal-*)` references for all visual properties to maintain theming consistency. Add `:focus-visible` with `box-shadow` using `--cal-focus-ring` (matching the Phase 4 focus indicator pattern for rounded/non-grid elements).
  </action>
  <verify>
Run `pnpm typecheck` -- no type errors.
Run `pnpm lint` -- no lint errors.
Run `pnpm build` -- build succeeds (views/list entry point works).
  </verify>
  <done>CalendarBody routes "list" view to ListView with correct props. List view CSS uses --cal-* variables for full theming support including dark mode. Focus-visible styles match Phase 4 accessibility patterns. Build succeeds with views/list entry point.</done>
</task>

</tasks>

<verification>
- `pnpm typecheck` succeeds
- `pnpm lint` succeeds
- `pnpm build` succeeds (views/list entry point produces output)
- `pnpm test:ci` -- all existing tests still pass (no regressions)
- Manually verify: in CalendarBody, switching to "list" view renders ListView (not null)
</verification>

<success_criteria>
1. ListView renders events filtered to dateRange, sorted chronologically, grouped by date
2. Date headers are sticky and show readable date format (e.g., "Monday, February 9, 2026")
3. Event rows show color dot, formatted time range (respecting hour12), and title
4. Clicking an event row calls onEventClick with the event
5. Empty state shows "No events to display" message
6. eventContent render slot overrides default title rendering
7. CalendarBody routes "list" case to ListView
8. All CSS uses --cal-* variables for theme compatibility
9. typecheck, lint, build all pass
</success_criteria>

<output>
After completion, create `.planning/phases/05-resources-listview/05-02-SUMMARY.md`
</output>
